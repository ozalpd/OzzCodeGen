<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:OzzLocalization.Wpf"
        xmlns:ViewModels="clr-namespace:OzzLocalization.Wpf.ViewModels"
        xmlns:Converters="clr-namespace:OzzUtils.Wpf.Converters;assembly=OzzUtils"
        x:Class="OzzLocalization.Wpf.MainWindow"
        mc:Ignorable="d"
        Title="Vocabulary Editor"
        Closing="Window_Closing"
        Height="320" Width="800" MinWidth="640"
        Activated="Window_Activated"
        Icon="Assets\App-organizer.ico">
    <Window.DataContext>
        <ViewModels:VocabularyEditorVM/>
    </Window.DataContext>
    <Window.Resources>
        <Converters:BoolToColor x:Key="IsTranslatedConverter" ColorForFalseValue="#FFFFDFDA" />
        <Converters:BoolToColor x:Key="IsTranslatedConverterHeader" ColorForFalseValue="#700" ColorForTrueValue="#050" />
        <Converters:BoolToColor x:Key="FileExistsConverter" ColorForFalseValue="#FFD00000" ColorForTrueValue="#FF00C000" />
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*" MinWidth="320"/>
            <ColumnDefinition Width="2*" MinWidth="320"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="30" />
            <RowDefinition Height="30" />
            <RowDefinition Height="*" />
            <RowDefinition Height="24" />
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal" Grid.ColumnSpan="2">
            <Button x:Name="btnNewProject" ToolTip="New Project" Click="btnNewProject_Click" Style="{StaticResource toolbarButtons}">
                <Image Source="Assets\NewDocumentHS.png" Stretch="None"/>
            </Button>
            <Button x:Name="btnOpen" Click="btnOpen_Click" ToolTip="Open Project" Style="{StaticResource toolbarButtons}" >
                <Image Source="Assets\openHS.png" Stretch="None" />
            </Button>
            <Button x:Name="btnSave" ToolTip="Save Project" Click="btnSave_Click" Style="{StaticResource toolbarButtons}"  >
                <Image Source="Assets\saveHS.png" Stretch="None"/>
            </Button>
            <Button x:Name="btnRefresh" ToolTip="Combine Vocabularies"
				Click="btnRefresh_Click"
				Style="{StaticResource toolbarButtons}">
                <Image Source="Assets\refresh_16.png" Stretch="None" />
            </Button>
            <TextBlock Text="Select Culture:" Margin="6,8,2,6"/>
            <ComboBox ItemsSource="{Binding CultureCodes}"
                      SelectedItem="{Binding SelectedCultureCode}" 
                      Width="60" Margin="4" HorizontalAlignment="Left"
                      IsEnabled="{Binding CanSelectCultureCode}" />
        </StackPanel>
        <StackPanel Orientation="Horizontal" Grid.Row="1" Grid.ColumnSpan="2">
            <ComboBox ItemsSource="{Binding AppSettings.RecentProjects}"
                      SelectedItem="{Binding SelectedProject}" 
                      Width="200" Margin="4,4,34,4" HorizontalAlignment="Left">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Fill="{Binding DirectoryExists, Converter={StaticResource FileExistsConverter}}"
                                         Width="6" Height="6" Margin="0,0,2,0" />
                            <TextBlock Text="{Binding Path=Title}" ToolTip="{Binding Path=FullPath}" MinWidth="182"/>
                        </StackPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <Button Name="btnFilter" Content="Filter" Margin="6,4,2,4" Width="60" Click="btnFilter_Click"/>
            <TextBlock Text="By Text:" Margin="6,8,2,6"/>
            <TextBox Name="txtFilter" Text="{Binding FilterByAnyString}" Margin="6,4,2,4" Width="80" KeyDown="txtFilter_KeyDown"/>
            <!--
            <TextBlock Text="By Name:" Margin="6,8,2,6"/>
            <TextBox Text="{Binding FilterByName}" Margin="6,4,2,4" Width="80"/>
            <TextBlock Text="By Translation:" Margin="6,8,2,6"/>
            <TextBox Text="{Binding FilterByTranslation}" Margin="6,4,2,4" Width="80"/>
            -->
            <CheckBox IsChecked="{Binding FilterUntranslatedOnly}"
                      Content="Untranslateds Only" Margin="6,8,2,6"/>
        </StackPanel>

        <!-- Left side -->
        <DataGrid ItemsSource="{Binding SelectedVocabulary}"
                  SelectedItem="{Binding SelectedVocab, Mode=TwoWay}"
                  AutoGenerateColumns="False" Grid.Row="2"
                  SelectionMode="Single"
                  SelectionChanged="DataGrid_SelectionChanged">
            <DataGrid.Columns>
                <DataGridTemplateColumn Header="Name (Clause)" Width="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Name}"
                                       Background="{Binding IsTranslated, Converter={StaticResource IsTranslatedConverter}}"
                                       Foreground="Black"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Translation" Width="180">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Translation}"
                                       Background="{Binding IsTranslated, Converter={StaticResource IsTranslatedConverter}}"
                                       Foreground="Black"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <DataGridTemplateColumn.CellEditingTemplate>
                        <DataTemplate>
                            <TextBox Text="{Binding Translation}" Padding="0" Height="20" Margin="-4,-2" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellEditingTemplate>
                </DataGridTemplateColumn>
                <DataGridTextColumn Binding="{Binding RequiredMsg}" Header="Required Message" Width="120"/>
                <DataGridTextColumn Binding="{Binding ValidationMsg}" Header="Validation Message" Width="120"/>
                <DataGridTextColumn Binding="{Binding ToolTip}" Header="ToolTip (Hint)" Width="120"/>

                <DataGridCheckBoxColumn Binding="{Binding IsTranslated, Mode=OneWay}" Header="Translated" Width="40" IsReadOnly="True"/>
            </DataGrid.Columns>
        </DataGrid>
        
        <GridSplitter Grid.Row="2" Grid.Column="1" HorizontalAlignment="Left" ResizeDirection="Columns" Width="6" />
        <!-- Right side-->
        <Border BorderBrush="#046" BorderThickness="2"
                Grid.Column="1"  Grid.Row="2" Margin="6,0">
            <Grid DataContext="{Binding SelectedVocab}">
                <Grid.Resources>
                    <Style TargetType="TextBlock">
                        <Setter Property="VerticalAlignment" Value="Stretch"/>
                        <Setter Property="TextAlignment" Value="Center"/>
                        <Setter Property="Padding" Value="7"/>
                        <Setter Property="Margin" Value="0,2,0,0"/>
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="Background" Value="#FF0080E0"/>
                        <Setter Property="Foreground" Value="#FFF"/>
                    </Style>
                    <Style TargetType="TextBox">
                        <Setter Property="Margin" Value="1,2"/>
                    </Style>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" MaxWidth="132"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="38"/>
                    <RowDefinition Height="32"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock Text="Clause" Grid.ColumnSpan="2" Margin="0,0,0,4" Padding="3" FontSize="20"/>
                <TextBlock Text="{Binding Name}"
                           Grid.ColumnSpan="3"
                           Background="{Binding IsTranslated, Converter={StaticResource IsTranslatedConverterHeader}}"
                           Padding="2" Margin="0,0,0,4"
                           FontSize="20"/>

                <TextBlock Text="Translation" Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2"/>
                <TextBox Name="txtTranslation" Text="{Binding Translation}"
                         Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="2"
                         KeyUp="txtTranslation_KeyUp" GotFocus="txtTranslation_GotFocus"/>
            </Grid>
        </Border>
        <!-- Bottom -->
        <StatusBar Grid.Row="3" Grid.ColumnSpan="2">
            <TextBlock Text="{Binding SelectedProject, Mode=OneWay, StringFormat=Project: \{0\}, TargetNullValue='Project: None opened!'}" Margin="4,0"/>
            <TextBlock Text="{Binding SelectedCultureCode, Mode=OneWay, StringFormat=Culture: \{0\}, TargetNullValue=''}" Margin="4,0" Width="80"/>
            <TextBlock Text="{Binding SelectedVocabulary.Count, Mode=OneWay, StringFormat=Displaying: \{0\}}" Margin="4,0"/>
        </StatusBar>
    </Grid>
</Window>
