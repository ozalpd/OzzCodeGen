// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 14.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace OzzCodeGen.CodeEngines.AspNetMvc.Templates
{
    using System.Linq;
    using System.Text;
    using System.Collections.Generic;
    using OzzCodeGen.Templates;
    using OzzCodeGen.Templates.Cs;
    using OzzCodeGen.Definitions;
    using OzzUtils;
    using System;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "14.0.0.0")]
    public partial class MvcAgGridIndexView : AbstracMvcIndexView
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            
            #line 10 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
 
bool searchable = Entity.DisplayColumns.Where(e => e.UseInSearch).Any();
var properties = Entity.DisplayColumns.Where(e => e.InIndexView);
var collectionProperties = Entity.GetInheritedCollectionProperties();
var entitiesThisForCreate = Entity.GetEntitiesStrongForThis();
var gridId = Entity.Name.ToCamelCase() + "Grid";

var pkeyProperty = Entity.GetPrimaryKey();
string pKey = pkeyProperty == null ? "Id" : pkeyProperty.Name;

WriteUsingNamespaces(); 
            
            #line default
            #line hidden
            this.Write("@model IEnumerable<");
            
            #line 21 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.Name));
            
            #line default
            #line hidden
            this.Write(">\r\n\r\n@{\r\n    ViewBag.Title = @");
            
            #line 24 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(EntityResource));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 24 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.Name.Pluralize()));
            
            #line default
            #line hidden
            this.Write(";\r\n\r\n    //Authorization Flags\r\n    bool canUserEdit = ViewBag.canUserEdit;\r\n    " +
                    "bool canUserCreate = ViewBag.canUserCreate;\r\n    bool canUserDelete = ViewBag.ca" +
                    "nUserDelete;\r\n    bool canSeeRestricted = ViewBag.canSeeRestricted;\r\n\r\n    var t" +
                    "itle = ");
            
            #line 32 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(EntityResource));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 32 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.Name.Pluralize()));
            
            #line default
            #line hidden
            this.Write(";\r\n}\r\n<div class=\"well hidden-print\">\r\n    <div class=\"row\">\r\n        <div class=" +
                    "\"col-md-8 col-sm-7\">\r\n            <h4>@title</h4>\r\n        </div>\r\n");
            
            #line 39 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
  if(searchable)
    { 
            
            #line default
            #line hidden
            this.Write("            <div class=\"col-md-4 col-sm-5\">\r\n                @Html.Partial(\"_Sear" +
                    "chBoxPartial\")\r\n            </div>\r\n");
            
            #line 44 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
  } 
            
            #line default
            #line hidden
            this.Write(@"    </div>
</div>
<div id=""mainGrid"" class=""ag-style ag-basic"" style=""width:100%;height:580px;""></div>
<nav><ul id=""pagerUl"" class=""pagination""></ul></nav>
@Html.Partial(""_MessageBoxPartial"")
@section scripts{
    @Scripts.Render(""~/js/ag-grid"")
    @Html.Partial(""_IndexScriptsPartial"", """);
            
            #line 52 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.ControllerName));
            
            #line default
            #line hidden
            this.Write("\") @* Controller\'s name *@\r\n    @Html.Partial(\"_agGridScriptsPartial\", \"/");
            
            #line 53 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.ControllerName));
            
            #line default
            #line hidden
            this.Write("/Get");
            
            #line 53 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.Name));
            
            #line default
            #line hidden
            this.Write(@"PagedList"") @* Service url *@
    <script type=""text/javascript"">
        var result = @Html.Raw(ViewBag.result);
        var gridOptions;

        var initPage = function() {
            var init = this;
            init.columnDefs = columnDefs();
            init.gridOptions = {
                columnDefs: init.columnDefs,
                rowHeight: 26,
                pageSize: result.pageSize,
                headerHeight: 32,
                rowData: result.Items,
                overlayNoRowsTemplate: '<span class=""fontSize150pc"">@MessageStrings.NoResults</span>'
            };

            function columnDefs(){
                return[
                     { headerName: '@ActionStrings.Action', field: """);
            
            #line 72 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(pKey));
            
            #line default
            #line hidden
            this.Write("\", width: 64, cellRenderer: actionCellRenderer},\r\n");
            
            #line 73 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
 foreach (var property in properties) { 
            
            #line default
            #line hidden
            this.Write("                     { headerName: \'@Html.DisplayNameFor(m => m.");
            
            #line 74 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(property.Name));
            
            #line default
            #line hidden
            this.Write(")\', field: \"");
            
            #line 74 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(property.Name));
            
            #line default
            #line hidden
            this.Write("\", width: 180 },\r\n");
            
            #line 75 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
 } 
            
            #line default
            #line hidden
            this.Write(@"                ];
            }

            function actionCellRenderer(params) {
                var actions = '<div class=""btn-group"" style=""margin-top:-3px;"">' +
                    '<button type=""button"" title=""@ActionStrings.Action"" class=""btn btn-xs btn-primary dropdown-toggle"" data-toggle=""dropdown"" onclick=""onActionMenuClick(this)"">' +
                    '<span class=""glyphicon glyphicon-tasks""></span> <span class=""caret""></span>' +
                    '</button>' +
                    '<ul class=""dropdown-menu mb15"" role=""menu"">' +
                    '<li><a href=""@Url.Action(""Details"")/' + params.value + '"">@ActionStrings.Details</a></li>' +
                @if (canUserEdit)
                {
                    @:'<li><a href=""@Url.Action(""Edit"")/' + params.value + '"">@ActionStrings.Edit</a></li>' +
                }
                @if(canUserDelete)
                {
                    @:'<li><a href=""#deleteConfirm"" data-toggle=""modal"" onclick=""setDelete(getObjectById(result.Items,' + params.value + ').");
            
            #line 92 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(DisplayMember));
            
            #line default
            #line hidden
            this.Write(", \' + params.value + \');\">@ActionStrings.Delete</a></li>\' +\r\n                }\r\n");
            
            #line 94 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
  if (entitiesThisForCreate.Any()) 
    { 
            
            #line default
            #line hidden
            this.Write("                    \'<li class=\"divider\"></li>\' +\r\n");
            
            #line 97 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
        foreach (var entity in entitiesThisForCreate)
        {
            
            #line default
            #line hidden
            this.Write("                @if (canUserCreate)\r\n                {\r\n                    @:\'<l" +
                    "i><a href=\"/");
            
            #line 101 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.ControllerName));
            
            #line default
            #line hidden
            this.Write("/Create/?");
            
            #line 101 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.StrongDependedForeignKey.ToCamelCase()));
            
            #line default
            #line hidden
            this.Write("=\' + params.value + \'\">@");
            
            #line 101 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(EntityResource));
            
            #line default
            #line hidden
            this.Write(".Add");
            
            #line 101 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("</a></li>\' +\r\n                }\r\n                    \'<li><a href=\"/");
            
            #line 103 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.ControllerName));
            
            #line default
            #line hidden
            this.Write("/Index/?");
            
            #line 103 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.StrongDependedForeignKey.ToCamelCase()));
            
            #line default
            #line hidden
            this.Write("=\' + params.value + \'\">@");
            
            #line 103 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(EntityResource));
            
            #line default
            #line hidden
            this.Write(".");
            
            #line 103 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name.Pluralize()));
            
            #line default
            #line hidden
            this.Write("</a></li>\' +\r\n");
            
            #line 104 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
        } 
            
            #line default
            #line hidden
            
            #line 105 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\AspNetMvc\Templates\MvcAgGridIndexView.tt"
  } 
            
            #line default
            #line hidden
            this.Write("                    \'</ul></div>\';\r\n\r\n                return actions;\r\n          " +
                    "  }\r\n\r\n            function boolCellRenderer(params) {\r\n                if(param" +
                    "s.value){\r\n                    return \'<span style=\"font-size:16px;\" class=\"glyp" +
                    "hicon glyphicon-check text-success\"></span>\';\r\n                }\r\n              " +
                    "  else{\r\n                    return \'<span style=\"font-size:16px;\" class=\"glyphi" +
                    "con glyphicon-unchecked text-danger\"></span>\';\r\n                }\r\n            }" +
                    "\r\n\r\n            $.ajaxSetup({ cache: false });\r\n            gridOptions = init.g" +
                    "ridOptions;\r\n            // angularGrid is a global function\r\n            agGrid" +
                    "GlobalFunc(\'#mainGrid\', gridOptions);\r\n\r\n            setPagerButtons($(\'#pagerUl" +
                    "\'), result.Page, result.PageCount);\r\n            displayRecordStats(result.Items" +
                    ".length, result.TotalCount);\r\n        }\r\n\r\n        function onActionMenuClick(me" +
                    "nuBtn){\r\n            setTimeout(function(){\r\n                var menuHeight = 22" +
                    "0;\r\n                var rectMenu = menuBtn.getBoundingClientRect();\r\n           " +
                    "     var rectGrid = document.getElementById(\"mainGrid\").getBoundingClientRect();" +
                    "\r\n\r\n                var diffY = rectGrid.bottom - rectMenu.bottom - menuHeight;\r" +
                    "\n                if (diffY < 0) {\r\n                    var viewport = $(\'#mainGr" +
                    "id .ag-body-viewport\');\r\n                    var viewportScroll = viewport.scrol" +
                    "lTop();\r\n                    viewport.scrollTop((diffY * -1) + viewportScroll);\r" +
                    "\n                }\r\n            },250);\r\n        }\r\n        document.addEventLis" +
                    "tener(\"DOMContentLoaded\", initPage());\r\n    </script>\r\n}");
            return this.GenerationEnvironment.ToString();
        }
    }
    
    #line default
    #line hidden
}
