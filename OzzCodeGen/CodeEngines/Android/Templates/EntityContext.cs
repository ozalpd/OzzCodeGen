// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 14.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace OzzCodeGen.CodeEngines.Android.Templates
{
    using System.Linq;
    using System.Text;
    using System.Collections.Generic;
    using OzzCodeGen.Utilities;
    using OzzCodeGen.CodeEngines.Java;
    using System;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "14.0.0.0")]
    public partial class EntityContext : AbstractDataHelper
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            
            #line 8 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 
    var storeProperties = Entity.GetStorageProperties();
	var primaryKey = Entity.GetPrimaryKey();
    WriteDeclataritons(); 
            
            #line default
            #line hidden
            this.Write("\r\npublic ");
            
            #line 13 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 if (!IsCustomFile){ 
            
            #line default
            #line hidden
            this.Write("abstract ");
            
            #line 13 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 } 
            
            #line default
            #line hidden
            this.Write("class ");
            
            #line 13 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ClassName));
            
            #line default
            #line hidden
            this.Write(" extends ");
            
            #line 13 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(BaseClassName));
            
            #line default
            #line hidden
            this.Write(" {\r\n\r\n\tpublic ");
            
            #line 15 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ClassName));
            
            #line default
            #line hidden
            this.Write("(");
            
            #line 15 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(AndroidCodeEngine.GeneratedDataContext));
            
            #line default
            #line hidden
            this.Write(" dataContext, String baseUrl) {\r\n");
            
            #line 16 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 if (IsCustomFile){ 
            
            #line default
            #line hidden
            this.Write("\t\tsuper(dataContext, baseUrl);\r\n\t}\r\n}\r\n");
            
            #line 20 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
	} else { 
            
            #line default
            #line hidden
            this.Write("\t\tsuper(dataContext, \"");
            
            #line 21 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetStorageTableName()));
            
            #line default
            #line hidden
            this.Write("\", baseUrl);\r\n\t\t\r\n\t\tcolName = new ColumnNames();\r\n\t\tcolIndex = new ColumnIndexes(" +
                    ");\r\n\t}\r\n\tprotected final ColumnNames colName;\r\n\tprotected final ColumnIndexes co" +
                    "lIndex;\r\n\r\n\r\n\t@Override\r\n\tprotected String getUniqueIdField() {\r\n\t\treturn colNam" +
                    "e.");
            
            #line 32 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primaryKey.JavaName));
            
            #line default
            #line hidden
            this.Write(";\r\n\t}\r\n\t@Override\r\n\tprotected String getColumnNames() {\r\n");
            
            #line 36 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
  
StringBuilder sb = new StringBuilder();
foreach(var property in storeProperties)
{
	if(sb.Length > 0){
		sb.Append(", ");
    }
	sb.Append(property.Name);
} 
            
            #line default
            #line hidden
            this.Write("\t\treturn \"");
            
            #line 45 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(sb.ToString()));
            
            #line default
            #line hidden
            this.Write("\";\r\n\t}\r\n\t\r\n\t@Override\r\n\tprotected String getWhereClause(");
            
            #line 49 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.Name));
            
            #line default
            #line hidden
            this.Write(" entity) {\r\n\t\treturn String.format(\"%s = %s\", getUniqueIdField(), entity.");
            
            #line 50 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primaryKey.Getter));
            
            #line default
            #line hidden
            this.Write("());\r\n\t}\r\n\t\r\n\t@Override\r\n\tprotected ");
            
            #line 54 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.Name));
            
            #line default
            #line hidden
            this.Write(" getEntityFromCursor(Cursor c){\r\n\t\tif(c.getPosition() < 0){\r\n\t\t\treturn null;\r\n\t\t}" +
                    "\r\n\t\t");
            
            #line 58 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.Name));
            
            #line default
            #line hidden
            this.Write(" entity = new ");
            
            #line 58 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.Name));
            
            #line default
            #line hidden
            this.Write("();\r\n");
            
            #line 59 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 foreach(var property in storeProperties) { 
            
            #line default
            #line hidden
            this.Write("\t\tentity.");
            
            #line 60 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(property.GetCursorSetter("c", "colIndex." + property.JavaName, "dbContext.unixTimeToDate")));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 61 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 } 
            
            #line default
            #line hidden
            this.Write("\t\t\r\n\t\treturn entity;\r\n\t}\r\n\r\n\t@Override\r\n\tpublic void save(");
            
            #line 67 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Entity.Name));
            
            #line default
            #line hidden
            this.Write(" entity) {\r\n");
            
            #line 68 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
  
sb = new StringBuilder();
foreach(var property in storeProperties)
{
	if(sb.Length > 0){
		sb.Append(", ");
    }
	if (property.PropertyDefinition.IsTypeString())
    {
		sb.Append("'%s'");
    }
	else
    {
		sb.Append("%s");
    }
} 
            
            #line default
            #line hidden
            this.Write("\t\tString saveStatement = String.format(\r\n\t\t\t\t\"Insert or Replace into %s (%s) Valu" +
                    "es (");
            
            #line 85 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(sb.ToString()));
            
            #line default
            #line hidden
            this.Write(");\", \r\n\t\t\t\ttableName,\r\n\t\t\t\tgetColumnNames(),\r\n");
            
            #line 88 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
  
int i = 0;
foreach(var property in storeProperties)
{
	i++; 
            
            #line default
            #line hidden
            this.Write("\t\t\t\t");
            
            #line 93 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(property.GetStorageGetter("entity", "dbContext.castToUnixTime")));
            
            #line default
            #line hidden
            
            #line 93 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 if (i < storeProperties.Count) { 
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 93 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 } else { 
            
            #line default
            #line hidden
            this.Write(");");
            
            #line 93 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 } 
            
            #line default
            #line hidden
            this.Write(" \r\n");
            
            #line 94 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 } 
            
            #line default
            #line hidden
            this.Write(@"		
		Log.v(""Saving"", saveStatement);
		
		SQLiteDatabase db = dbContext.getWritableDatabase();
		db.execSQL(saveStatement);
		db.close();
		
		dataContext.onEntitySaved(entity);
	}

	@Override
	public void downloadAll() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void downloadById(int uniqueId) {
		// TODO Auto-generated method stub
		
	}

	public class ColumnNames{
");
            
            #line 118 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
  
foreach(var property in storeProperties)
{ 
            
            #line default
            #line hidden
            this.Write("\t\tpublic final String ");
            
            #line 121 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(property.JavaName));
            
            #line default
            #line hidden
            this.Write(" = \"");
            
            #line 121 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(property.Name));
            
            #line default
            #line hidden
            this.Write("\";\r\n");
            
            #line 122 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 } 
            
            #line default
            #line hidden
            this.Write("\t}\r\n\tpublic class ColumnIndexes{\r\n");
            
            #line 125 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
  
i = -1;
foreach(var property in storeProperties)
{
	i++; 
            
            #line default
            #line hidden
            this.Write("\t\tpublic final int ");
            
            #line 130 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(property.JavaName));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 130 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(i));
            
            #line default
            #line hidden
            this.Write(";\r\n");
            
            #line 131 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 } 
            
            #line default
            #line hidden
            this.Write("\t}\r\n}\r\n");
            
            #line 134 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Android\Templates\EntityContext.tt"
 } 
            
            #line default
            #line hidden
            return this.GenerationEnvironment.ToString();
        }
    }
    
    #line default
    #line hidden
}
