// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 14.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace OzzCodeGen.CodeEngines.Storage.Templates.MsSql
{
    using System.Linq;
    using System.Text;
    using System.Collections.Generic;
    using System;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "14.0.0.0")]
    public partial class TsqlStoredProcs : AbstractStorageTemplate
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            this.Write("SET ANSI_NULLS ON\r\nGO\r\nSET QUOTED_IDENTIFIER ON\r\nGO\r\n\r\n");
            
            #line 12 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  var firstBase = TableDefinition.GetFirstBase();
	string pkeyVal = "@" + firstBase.PrimaryKeyColumn.Name;
	var deleteMarkColumn = firstBase.GetDeleteMarkColumn();

            
            #line default
            #line hidden
            this.Write("-- --------------------------------------------------------------------\r\n-- Store" +
                    "d Procedure: [");
            
            #line 17 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 17 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Delete]\r\n-- --------------------------------------------------------------------" +
                    "\r\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N\'[");
            
            #line 19 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 19 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Delete]\') AND type in (N\'P\', N\'PC\'))\r\nDROP PROCEDURE [");
            
            #line 20 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 20 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Delete]\r\nGO\r\nCREATE PROCEDURE [");
            
            #line 22 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 22 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Delete]\r\n\t");
            
            #line 23 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(pkeyVal));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 23 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetColumnType(firstBase.PrimaryKeyColumn)));
            
            #line default
            #line hidden
            this.Write("\r\nAs\r\nBegin\r\n");
            
            #line 26 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"

if(deleteMarkColumn != null)
{
 
            
            #line default
            #line hidden
            this.Write("    Declare @");
            
            #line 30 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(deleteMarkColumn.Name));
            
            #line default
            #line hidden
            this.Write(" bit\r\n\r\n\tSelect @");
            
            #line 32 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(deleteMarkColumn.Name));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 32 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(deleteMarkColumn.Name));
            
            #line default
            #line hidden
            this.Write("\r\n\t\tFrom [");
            
            #line 33 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 33 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.TableName));
            
            #line default
            #line hidden
            this.Write("]\r\n\t\tWhere ");
            
            #line 34 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.PrimaryKeyColumn));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 34 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(pkeyVal));
            
            #line default
            #line hidden
            this.Write("\r\n\r\n\tIf @");
            
            #line 36 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(deleteMarkColumn.Name));
            
            #line default
            #line hidden
            this.Write(" = 1\r\n\tBegin\r\n\t\t/* TODO: Check cascaded data from other tables */\r\n");
            
            #line 39 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  PushIndent("    ");
	WriteDeleteStatement(TableDefinition, firstBase, pkeyVal);
	PopIndent(); 
            
            #line default
            #line hidden
            this.Write("\t\t\r\n\tEnd\r\n\tElse\r\n\tBegin\r\n\t\tUpdate [");
            
            #line 46 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 46 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.TableName));
            
            #line default
            #line hidden
            this.Write("]\r\n\t\t\tSet ");
            
            #line 47 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(deleteMarkColumn.Name));
            
            #line default
            #line hidden
            this.Write(" = 1\r\n\t\t\tWhere [");
            
            #line 48 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.PrimaryKeyColumn));
            
            #line default
            #line hidden
            this.Write("] = ");
            
            #line 48 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(pkeyVal));
            
            #line default
            #line hidden
            this.Write("\r\n\tEnd\r\n");
            
            #line 50 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} else { 
            
            #line default
            #line hidden
            this.Write("\t/* TODO: Check cascaded data from other tables */\r\n");
            
            #line 52 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 WriteDeleteStatement(TableDefinition, firstBase, pkeyVal); 
            
            #line default
            #line hidden
            
            #line 53 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"

} 
            
            #line default
            #line hidden
            this.Write("End\r\nGo\r\n-- --------------------------------------------------------------------\r" +
                    "\n-- Stored Procedure: [");
            
            #line 58 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 58 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Insert]\r\n-- --------------------------------------------------------------------" +
                    "\r\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N\'[");
            
            #line 60 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 60 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Insert]\') AND type in (N\'P\', N\'PC\'))\r\nDROP PROCEDURE [");
            
            #line 61 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 61 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Insert]\r\nGO\r\nCREATE PROCEDURE [");
            
            #line 63 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 63 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Insert]\r\n");
            
            #line 64 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
		
	var colDeclaresIns = TableDefinition.GetColumnList().Where(c => c.PrimaryKey == false & c.Exclude == false & string.IsNullOrEmpty(c.InsertDefault));
	int colNr = 0;
	foreach (var column in colDeclaresIns)
	{ 
			colNr++;
            
            #line default
            #line hidden
            this.Write("\t@");
            
            #line 70 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 70 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetColumnType(column)));
            
            #line default
            #line hidden
            
            #line 70 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(colNr < colDeclaresIns.Count()) {
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 70 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  } 
            
            #line default
            #line hidden
            this.Write(" \r\n");
            
            #line 71 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
            
            #line default
            #line hidden
            this.Write("As\r\nBegin\r\n    Declare @NewKey\t\t");
            
            #line 74 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.PrimaryKeyColumn.DataType));
            
            #line default
            #line hidden
            this.Write("\r\n\r\n");
            
            #line 76 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 WriteInsertStatement(firstBase, string.Empty); 
            
            #line default
            #line hidden
            this.Write("\r\n\tSet @NewKey = SCOPE_IDENTITY()\r\n");
            
            #line 79 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  if(TableDefinition.UseInheritance)
	{ 
            
            #line default
            #line hidden
            this.Write("\r\n");
            
            #line 82 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 WriteInsertStatement(TableDefinition, "@NewKey"); 
            
            #line default
            #line hidden
            
            #line 83 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
            
            #line default
            #line hidden
            this.Write("\r\n");
            
            #line 85 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 WriteSelectStatement("@NewKey"); 
            
            #line default
            #line hidden
            this.Write("End\r\nGo\r\n-- --------------------------------------------------------------------\r" +
                    "\n-- Stored Procedure: [");
            
            #line 89 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 89 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Update]\r\n-- --------------------------------------------------------------------" +
                    "\r\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N\'[");
            
            #line 91 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 91 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Update]\') AND type in (N\'P\', N\'PC\'))\r\nDROP PROCEDURE [");
            
            #line 92 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 92 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Update]\r\nGO\r\n");
            
            #line 94 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
	var colDeclaresUpd = TableDefinition.GetColumnList().Where(c => c.PrimaryKey == false & c.Exclude == false & string.IsNullOrEmpty(c.UpdateDefault));

            
            #line default
            #line hidden
            this.Write("CREATE PROCEDURE [");
            
            #line 97 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 97 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Update]\r\n\t");
            
            #line 98 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(pkeyVal));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 98 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetColumnType(firstBase.PrimaryKeyColumn)));
            
            #line default
            #line hidden
            this.Write(",\r\n");
            
            #line 99 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
		
	colNr = 0;
	foreach (var column in colDeclaresUpd)
	{ 
			colNr++;
            
            #line default
            #line hidden
            this.Write("\t@");
            
            #line 104 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 104 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetColumnType(column)));
            
            #line default
            #line hidden
            
            #line 104 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(colNr < colDeclaresUpd.Count()) {
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 104 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  } 
            
            #line default
            #line hidden
            this.Write(" \r\n");
            
            #line 105 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
            
            #line default
            #line hidden
            this.Write("As\r\nBegin\r\n\r\n");
            
            #line 109 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 WriteUpdateStatement(TableDefinition, pkeyVal); 
            
            #line default
            #line hidden
            
            #line 110 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  if(TableDefinition.UseInheritance)
	{ 
            
            #line default
            #line hidden
            this.Write("\r\n");
            
            #line 113 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 WriteUpdateStatement(firstBase, pkeyVal); 
            
            #line default
            #line hidden
            
            #line 114 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
            
            #line default
            #line hidden
            this.Write("\r\n");
            
            #line 116 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 WriteSelectStatement(pkeyVal); 
            
            #line default
            #line hidden
            this.Write("End\r\nGo\r\n\r\n-- -------------------------------------------------------------------" +
                    "-\r\n-- Stored Procedure: [");
            
            #line 121 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 121 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_InsertOrUpdate]\r\n-- ------------------------------------------------------------" +
                    "--------\r\n");
            
            #line 123 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(false){ 
            
            #line default
            #line hidden
            this.Write("IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N\'[");
            
            #line 124 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 124 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_InsertOrUpdate]\') AND type in (N\'P\', N\'PC\'))\r\nDROP PROCEDURE [");
            
            #line 125 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 125 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_InsertOrUpdate]\r\nGO\r\nCREATE PROCEDURE [");
            
            #line 127 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 127 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_InsertOrUpdate]\r\n\t");
            
            #line 128 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(pkeyVal));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 128 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetColumnType(firstBase.PrimaryKeyColumn)));
            
            #line default
            #line hidden
            this.Write(",\r\n");
            
            #line 129 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
		
	colNr = 0;
	foreach (var column in colDeclaresUpd)
	{ 
			colNr++;
            
            #line default
            #line hidden
            this.Write("\t@");
            
            #line 134 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));
            
            #line default
            #line hidden
            this.Write(" ");
            
            #line 134 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(GetColumnType(column)));
            
            #line default
            #line hidden
            this.Write(",\r\n");
            
            #line 135 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
            
            #line default
            #line hidden
            this.Write("\t@Result int OUTPUT\r\nAs\r\nBegin\r\n\tSet @Result = 0\r\n\tIf Not Exists (Select * from [" +
                    "");
            
            #line 140 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 140 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("] Where ");
            
            #line 140 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.PrimaryKeyColumn.Name));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 140 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(pkeyVal));
            
            #line default
            #line hidden
            this.Write(")\r\n\tBegin\r\n\t\tExec [");
            
            #line 142 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 142 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Insert]\r\n");
            
            #line 143 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
		
	colNr = 0;
	foreach (var column in colDeclaresIns)
	{ 
			colNr++;
            
            #line default
            #line hidden
            this.Write("\t\t\t@");
            
            #line 148 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));
            
            #line default
            #line hidden
            this.Write(" = @");
            
            #line 148 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));
            
            #line default
            #line hidden
            
            #line 148 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(colNr < colDeclaresUpd.Count()) {
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 148 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  } 
            
            #line default
            #line hidden
            this.Write(" \r\n");
            
            #line 149 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
            
            #line default
            #line hidden
            this.Write("\t\tSet @Result = 1\r\n\tEnd\r\n\tElse\r\n\tBegin\r\n\t\tExec [");
            
            #line 154 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));
            
            #line default
            #line hidden
            this.Write("].[");
            
            #line 154 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));
            
            #line default
            #line hidden
            this.Write("_Update]\r\n\t\t\t");
            
            #line 155 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(pkeyVal));
            
            #line default
            #line hidden
            this.Write(" = ");
            
            #line 155 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(pkeyVal));
            
            #line default
            #line hidden
            this.Write(",\r\n");
            
            #line 156 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
		
	colNr = 0;
	foreach (var column in colDeclaresUpd)
	{ 
			colNr++;
            
            #line default
            #line hidden
            this.Write("\t\t\t@");
            
            #line 161 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));
            
            #line default
            #line hidden
            this.Write(" = @");
            
            #line 161 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));
            
            #line default
            #line hidden
            
            #line 161 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(colNr < colDeclaresUpd.Count()) {
            
            #line default
            #line hidden
            this.Write(",");
            
            #line 161 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  } 
            
            #line default
            #line hidden
            this.Write(" \r\n");
            
            #line 162 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
            
            #line default
            #line hidden
            this.Write("\t\tSet @Result = -1\r\n\tEnd\r\nEnd\r\nGo\r\n");
            
            #line 167 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
            
            #line default
            #line hidden
            return this.GenerationEnvironment.ToString();
        }
        
        #line 168 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
protected void WriteDeleteStatement(StorageEntitySetting table, StorageEntitySetting baseTable,string pkeyValue)
{ 
        
        #line default
        #line hidden
        
        #line 170 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\tDelete From [");

        
        #line default
        #line hidden
        
        #line 171 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.SchemaName));

        
        #line default
        #line hidden
        
        #line 171 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 171 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.TableName));

        
        #line default
        #line hidden
        
        #line 171 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("]\r\n\t\tWhere [");

        
        #line default
        #line hidden
        
        #line 172 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.SchemaName));

        
        #line default
        #line hidden
        
        #line 172 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 172 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.TableName));

        
        #line default
        #line hidden
        
        #line 172 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 172 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.PrimaryKeyColumn.Name));

        
        #line default
        #line hidden
        
        #line 172 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("] = ");

        
        #line default
        #line hidden
        
        #line 172 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(pkeyValue));

        
        #line default
        #line hidden
        
        #line 172 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\r\n");

        
        #line default
        #line hidden
        
        #line 173 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(TableDefinition.UseInheritance)
	{ 
        
        #line default
        #line hidden
        
        #line 174 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\r\n\tDelete From [");

        
        #line default
        #line hidden
        
        #line 176 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(baseTable.SchemaName));

        
        #line default
        #line hidden
        
        #line 176 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 176 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(baseTable.TableName));

        
        #line default
        #line hidden
        
        #line 176 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("]\r\n\t\tWhere [");

        
        #line default
        #line hidden
        
        #line 177 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(baseTable.SchemaName));

        
        #line default
        #line hidden
        
        #line 177 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 177 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(baseTable.TableName));

        
        #line default
        #line hidden
        
        #line 177 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 177 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(baseTable.PrimaryKeyColumn.Name));

        
        #line default
        #line hidden
        
        #line 177 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("] = ");

        
        #line default
        #line hidden
        
        #line 177 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(pkeyValue));

        
        #line default
        #line hidden
        
        #line 177 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\r\n");

        
        #line default
        #line hidden
        
        #line 178 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
        
        #line default
        #line hidden
        
        #line 179 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
} 
        
        #line default
        #line hidden
        
        #line 181 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
protected void WriteUpdateStatement(StorageEntitySetting table, string pkeyValue)
{
	var columns = table.UseInheritance ?
			table.Properties.Where(c => c.PrimaryKey == false & c.Exclude == false & c.UpdateDefault != "NeverUpdate") :
			table.GetColumnList().Where(c => c.PrimaryKey == false & c.Exclude == false & c.UpdateDefault != "NeverUpdate");
	if(columns.Any())
    {
 
        
        #line default
        #line hidden
        
        #line 189 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\tUpdate [");

        
        #line default
        #line hidden
        
        #line 190 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.SchemaName));

        
        #line default
        #line hidden
        
        #line 190 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 190 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.TableName));

        
        #line default
        #line hidden
        
        #line 190 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("]\r\n\t\tSet ");

        
        #line default
        #line hidden
        
        #line 191 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	
	int colNr = 0;
	PushIndent("            ");
	foreach (var column in columns)
	{ 
		if(colNr != 0 & (colNr % 2 == 0)) { WriteLine(""); } 
		colNr++;
		string colValue = string.IsNullOrEmpty(column.UpdateDefault) ? "@" + column.Name : column.UpdateDefault.Replace("{TableName}", table.TableName);
		
        
        #line default
        #line hidden
        
        #line 199 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("[");

        
        #line default
        #line hidden
        
        #line 200 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));

        
        #line default
        #line hidden
        
        #line 200 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("] = ");

        
        #line default
        #line hidden
        
        #line 200 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(colValue));

        
        #line default
        #line hidden
        
        #line 200 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(colNr < columns.Count()) {
        
        #line default
        #line hidden
        
        #line 200 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(", ");

        
        #line default
        #line hidden
        
        #line 200 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 } 
        
        #line default
        #line hidden
        
        #line 201 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	}
    PopIndent();
	WriteLine("");
 
        
        #line default
        #line hidden
        
        #line 204 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\tWhere [");

        
        #line default
        #line hidden
        
        #line 205 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.SchemaName));

        
        #line default
        #line hidden
        
        #line 205 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 205 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.TableName));

        
        #line default
        #line hidden
        
        #line 205 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 205 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.PrimaryKeyColumn.Name));

        
        #line default
        #line hidden
        
        #line 205 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("] = ");

        
        #line default
        #line hidden
        
        #line 205 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(pkeyValue));

        
        #line default
        #line hidden
        
        #line 205 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\r\n");

        
        #line default
        #line hidden
        
        #line 206 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 }
} 
        
        #line default
        #line hidden
        
        #line 208 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
protected void WriteInsertStatement(StorageEntitySetting table, string pkeyValue)
{
	int varCount = 6;
	var columns = table.UseInheritance ?
			table.Properties.Where(c => c.PrimaryKey == false & c.Exclude == false) :
			table.GetColumnList().Where(c => c.PrimaryKey == false & c.Exclude == false);
 
        
        #line default
        #line hidden
        
        #line 215 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\tInsert Into [");

        
        #line default
        #line hidden
        
        #line 216 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.SchemaName));

        
        #line default
        #line hidden
        
        #line 216 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 216 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.TableName));

        
        #line default
        #line hidden
        
        #line 216 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("](\r\n");

        
        #line default
        #line hidden
        
        #line 217 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
	PushIndent("            ");
	if(!string.IsNullOrEmpty(pkeyValue)){ 
        
        #line default
        #line hidden
        
        #line 219 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.PrimaryKeyColumn.Name));

        
        #line default
        #line hidden
        
        #line 219 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(", ");

        
        #line default
        #line hidden
        
        #line 219 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 } 
        
        #line default
        #line hidden
        
        #line 220 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	
	int colNr = 0;
	foreach (var column in columns)
	{ 
		if(colNr != 0 & (colNr % varCount == 0)) { WriteLine(""); } 
		colNr++;
		
        
        #line default
        #line hidden
        
        #line 227 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));

        
        #line default
        #line hidden
        
        #line 227 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(colNr < columns.Count()) {
        
        #line default
        #line hidden
        
        #line 227 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(", ");

        
        #line default
        #line hidden
        
        #line 227 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  } else { 
        
        #line default
        #line hidden
        
        #line 227 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(")");

        
        #line default
        #line hidden
        
        #line 227 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  } 
        
        #line default
        #line hidden
        
        #line 228 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	}
    PopIndent();
	WriteLine("");
 
        
        #line default
        #line hidden
        
        #line 231 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\tValues (");

        
        #line default
        #line hidden
        
        #line 232 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(!string.IsNullOrEmpty(pkeyValue)){ 
        
        #line default
        #line hidden
        
        #line 232 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(pkeyValue));

        
        #line default
        #line hidden
        
        #line 232 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(", ");

        
        #line default
        #line hidden
        
        #line 232 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 } 
        
        #line default
        #line hidden
        
        #line 233 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	colNr = 0;
	PushIndent("            ");
	foreach (var column in columns)
	{ 
		if(colNr != 0 & (colNr % varCount == 0)) { WriteLine(""); } 
		colNr++;
		string colValue = string.IsNullOrEmpty(column.InsertDefault) ? "@" + column.Name : column.InsertDefault; 
        
        #line default
        #line hidden
        
        #line 240 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(colValue));

        
        #line default
        #line hidden
        
        #line 240 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(colNr < columns.Count()) {
        
        #line default
        #line hidden
        
        #line 240 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(", ");

        
        #line default
        #line hidden
        
        #line 240 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  } else { 
        
        #line default
        #line hidden
        
        #line 240 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(")");

        
        #line default
        #line hidden
        
        #line 240 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
  } 
        
        #line default
        #line hidden
        
        #line 241 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	}
    PopIndent();
	WriteLine("");
 
        
        #line default
        #line hidden
        
        #line 245 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
} 
        
        #line default
        #line hidden
        
        #line 247 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
protected void WriteSelectStatement(string keyValue)
{
	var firstBase = TableDefinition.GetFirstBase();
 
        
        #line default
        #line hidden
        
        #line 251 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\tSelect  [");

        
        #line default
        #line hidden
        
        #line 252 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.TableName));

        
        #line default
        #line hidden
        
        #line 252 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 252 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.PrimaryKeyColumn.Name));

        
        #line default
        #line hidden
        
        #line 252 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("],\r\n");

        
        #line default
        #line hidden
        
        #line 253 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 WriteSelectColumns(TableDefinition, TableDefinition.UseInheritance); 
        
        #line default
        #line hidden
        
        #line 254 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(TableDefinition.UseInheritance)
	{
		//TODO: Handle more than one inherited base
		WriteSelectColumns(firstBase); 
	} 
        
        #line default
        #line hidden
        
        #line 259 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 //TODO: Handle more than one inherited base
	if(TableDefinition.UseInheritance)
	{ 
        
        #line default
        #line hidden
        
        #line 261 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\tFrom  [");

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.SchemaName));

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.TableName));

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("] Inner Join [");

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("] On [");

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.TableName));

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.PrimaryKeyColumn.Name));

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("] = [");

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.PrimaryKeyColumn.Name));

        
        #line default
        #line hidden
        
        #line 262 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("]\r\n");

        
        #line default
        #line hidden
        
        #line 263 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} else { 
        
        #line default
        #line hidden
        
        #line 263 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\tFrom  [");

        
        #line default
        #line hidden
        
        #line 264 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.SchemaName));

        
        #line default
        #line hidden
        
        #line 264 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 264 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(TableDefinition.TableName));

        
        #line default
        #line hidden
        
        #line 264 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("]\r\n");

        
        #line default
        #line hidden
        
        #line 265 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	} 
        
        #line default
        #line hidden
        
        #line 265 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\tWhere [");

        
        #line default
        #line hidden
        
        #line 266 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.SchemaName));

        
        #line default
        #line hidden
        
        #line 266 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 266 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.TableName));

        
        #line default
        #line hidden
        
        #line 266 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 266 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(firstBase.PrimaryKeyColumn.Name));

        
        #line default
        #line hidden
        
        #line 266 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("] = ");

        
        #line default
        #line hidden
        
        #line 266 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(keyValue));

        
        #line default
        #line hidden
        
        #line 266 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("\r\n");

        
        #line default
        #line hidden
        
        #line 267 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
} 
        
        #line default
        #line hidden
        
        #line 269 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"

protected void WriteSelectColumns(StorageEntitySetting table, bool hasMore = false)
{	
	var columns = table.UseInheritance ?
			table.Properties.Where(c => c.PrimaryKey == false & c.Exclude == false) :
			table.GetColumnList().Where(c => c.PrimaryKey == false & c.Exclude == false);
	int colNr = 0;
	foreach (var column in columns)
	{
		colNr++; 
        
        #line default
        #line hidden
        
        #line 278 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("            [");

        
        #line default
        #line hidden
        
        #line 279 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(table.TableName));

        
        #line default
        #line hidden
        
        #line 279 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("].[");

        
        #line default
        #line hidden
        
        #line 279 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(this.ToStringHelper.ToStringWithCulture(column.Name));

        
        #line default
        #line hidden
        
        #line 279 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write("]");

        
        #line default
        #line hidden
        
        #line 279 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 if(colNr < columns.Count() | hasMore) {
        
        #line default
        #line hidden
        
        #line 279 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(",");

        
        #line default
        #line hidden
        
        #line 279 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 } 
        
        #line default
        #line hidden
        
        #line 279 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
this.Write(" \r\n");

        
        #line default
        #line hidden
        
        #line 280 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
	}

        
        #line default
        #line hidden
        
        #line 282 "F:\OzzCodeGen\OzzCodeGen\CodeEngines\Storage\Templates\MsSql\TsqlStoredProcs.tt"
 
} 
        
        #line default
        #line hidden
    }
    
    #line default
    #line hidden
}
